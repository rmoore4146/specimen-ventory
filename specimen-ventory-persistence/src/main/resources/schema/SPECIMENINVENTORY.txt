-- mysqldump -d -u <username> -p<password> -h <hostname> <dbname>


-- MySQL dump 10.13  Distrib 5.5.29, for osx10.6 (i386)
--
-- Host: localhost    Database: specimeninventory
-- ------------------------------------------------------
-- Server version	5.5.29
-- Date - 4/25/13

CREATE DATABASE `SPECIMENINVENTORY`

CREATE TABLE `SPECIMEN` (
  `ID` bigint(20) NOT NULL,
  `ANIMALUUID` varchar(255) DEFAULT NULL,
  PRIMARY KEY (`ID`),
  UNIQUE KEY `animalUUID_UNIQUE` (`ANIMALUUID`)
)

CREATE TABLE `SURGERY` (
  `ID` bigint(20) NOT NULL,
  `ANIMALUUID` bigint(20) DEFAULT NULL,
  `SURGERYDATE` datetime DEFAULT NULL,
  `TIMESTART` varchar(255) DEFAULT NULL,
  `TIMEEND` varchar(255) DEFAULT NULL,
  `SURGEON` varchar(255) DEFAULT NULL,
  `ANESTHESIATYPE` tinyblob,
  `ANESTHESIADOSE` varchar(255) DEFAULT NULL,
  `ANALGESIATYPE` tinyblob,
  `ANALGESIADOSE` varchar(255) DEFAULT NULL,
  `FREETEXT` varchar(255) DEFAULT NULL,
  `CUTDATE` datetime DEFAULT NULL,
  `PERFUSIONDATE` datetime DEFAULT NULL,
  `PERFUSIONPROCEDURE` varchar(255) DEFAULT NULL,
  `HISTOLOGY` varchar(255) DEFAULT NULL,
  `SURGERYDESCRIPTION` varchar(255) DEFAULT NULL,
  PRIMARY KEY (`ID`),
  KEY `FKBC55FDD597068ADF` (`ANIMALUUID`),
  CONSTRAINT `SPECIMEN_FK` FOREIGN KEY (`ANIMALUUID`) REFERENCES `SPECIMEN` (`ID`)
)

CREATE TABLE `PROCEDURETYPE_ASSOC` (
  `SURGERY_ID` bigint(20) NOT NULL,
  `PROCEDURETYPE` varchar(255) NOT NULL,
  KEY `PT_SURGERY_ID_IDX` (`SURGERY_ID`),
  CONSTRAINT `SURGERY_FK` FOREIGN KEY (`SURGERY_ID`) REFERENCES `SURGERY` (`ID`) ON DELETE CASCADE ON UPDATE NO ACTION
)

CREATE TABLE `PROCEDURETYPE_ASSOC` (
  `SURGERY_ID` bigint(20) NOT NULL,
  `PROCEDURETYPE` varchar(255) NOT NULL,
  KEY `PT_SURGERY_ID_IDX` (`SURGERY_ID`),
  CONSTRAINT `SURGERY_FK` FOREIGN KEY (`SURGERY_ID`) REFERENCES `SURGERY` (`ID`) ON DELETE CASCADE ON UPDATE NO ACTION
)

CREATE TABLE USERS (
   USERNAME VARCHAR(50) NOT NULL PRIMARY KEY,
   PASSWORD VARCHAR(50) NOT NULL,
   ENABLED BIT NOT NULL
);

CREATE TABLE AUTHORITIES (
   USERNAME VARCHAR(50) NOT NULL,
   AUTHORITIES VARCHAR(50) NOT NULL
);

/**CREATE UNIQUE INDEX IX_AUTH_USERNAME ON AUTHORITIES (USERNAME, AUTHORITIY);**/

ALTER TABLE AUTHORITIES ADD CONSTRAINT FK_AUTHORITIES_USER foreign key (USERNAME) REFERENCES USERS(USERNAME);

INSERT INTO users VALUES ('tom', 'p4ssw0rd1', true);
INSERT INTO users VALUES ('ryan', 'p4ssw0rd1', true);
INSERT INTO users VALUES ('courtney', 'p4ssw0rd1', true);
INSERT INTO users VALUES ('nathan', 'p4ssw0rd1', true);
INSERT INTO users VALUES ('pete', 'p4ssw0rd1', true);

INSERT INTO authorities VALUES ('tom', 'ROLE_ADMIN');
INSERT INTO authorities VALUES ('ryan', 'ROLE_ADMIN');
INSERT INTO authorities VALUES ('courtney', 'ROLE_USER');
INSERT INTO authorities VALUES ('nathan', 'ROLE_USER');
INSERT INTO authorities VALUES ('pete', 'ROLE_USER');

CREATE  TABLE `SPECIMENINVENTORY`.`TABLECOLUMNDEFINITION` (
  `ID` INT NOT NULL ,
  `ENABLED` BIT(1) NOT NULL ,
  `VIEWBYDEFAULT` BIT(1) NOT NULL ,
  `DATATYPE` TINYBLOB NOT NULL ,
  `COLUMNNAME` VARCHAR(45) NOT NULL ,
  `EDITABLE` BIT(1) NOT NULL ,
  PRIMARY KEY (`ID`) ,
  UNIQUE INDEX `COLUMNNAME_UNIQUE` (`COLUMNNAME` ASC) );
